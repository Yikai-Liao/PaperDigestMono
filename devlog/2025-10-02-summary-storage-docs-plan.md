# 2025-10-02 数据存储结构文档整理计划
Status: Completed
Last-updated: 2025-10-02

## 背景与现状
- 已完成论文元数据、嵌入、偏好、摘要的历史迁移，目录位于 `data/` 下，结构已经稳定。
- 文档层面仍主要依赖旧架构说明，缺少对现有本地优先数据形态的汇总，尤其是字段说明。
- 团队成员在讨论摘要语言字段命名时，需要集中化的文档可供查阅，以避免重复决策。

## 变更内容概览
1. 在 `devdoc/` 下新增专门的数据存储说明文档，覆盖各数据域（metadata/embeddings/preferences/summaries）的目录结构与字段契约。
2. 对每个数据域补充优缺点分析（现状 vs. 未来优化点），帮助后续规划。
3. 在 `devdoc/architecture.md` 中添加锚点或引用，指向新的文档。
4. 更新完成后记录在本文件中，并准备提交至 GitHub 主干。

## 风险评估
- **信息偏差**：如字段描述与实现不一致，可能误导后续开发 → 需对照迁移脚本 `papersys/migration/legacy.py` 与现有数据产物进行核对。
- **文档重复**：新增内容可能与现有架构文档重复 → 在新增文档中标注与旧描述的差异，并在架构文档中提供单一入口。
- **团队协作**：若计划未及时同步至他人 → 文档内标明版本日期，后续迭代可基于该版本增量更新。

## 执行步骤
1. 汇总当前迁移脚本产出的字段列表与数据文件结构。
2. 起草 `devdoc/data-storage.md`（暂名），包含目录结构、字段表、数据流程以及优势/劣势分析。
3. 在 `devdoc/architecture.md` 的数据层章节添加指向新文档的引用，并概述改动。
4. 自查文档内容与实现是否一致，特别是字段命名（如 `lang`）。
5. 最终整理提交信息，准备推送。

## 回滚方案
- 如文档内容存在错误，可直接回滚本次提交，恢复为新增文档前的状态。
- 若仅需局部修订，提交补丁文档即可；不存在数据库或代码层面的副作用。

## 执行记录
- 2025-10-02：完成 `devdoc/data-storage.md` 初版整理，并在 `devdoc/architecture.md` 中添加引用说明。
- 本次变更为纯文档更新，无需执行自动化测试。
